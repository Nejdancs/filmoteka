function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},a=n.parcelRequired76b;null==a&&((a=function(e){if(e in i)return i[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){s[e]=t},n.parcelRequired76b=a),a.register("kyEFX",(function(t,n){var i,s;e(t.exports,"register",(function(){return i}),(function(e){return i=e})),e(t.exports,"resolve",(function(){return s}),(function(e){return s=e}));var a={};i=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)a[t[n]]=e[t[n]]},s=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a("kyEFX").register(JSON.parse('{"5ZPII":"index.b06e6de5.js","lp5u4":"sprite.b12e0b11.svg"}'));
//!!!!!!!!! ОБЕ функции надо вызывать при старте
const o={};function r(){return{headerRef:{},homeRef:{},libraryButtonsRef:{btnWatched:document.querySelector(".js-btn-watched"),btnQueue:document.querySelector(".js-btn-queue")},paginationRef:{container:document.querySelector(".pag-container-js"),paginationList:document.querySelector(".pag-list-js"),pages:document.querySelectorAll(".js-page"),prev:document.querySelector(".prev-js"),next:document.querySelector(".next-js"),first:document.querySelector(".first-js"),last:document.querySelector(".last-js"),prevMore:document.querySelector(".prevMore-js"),nextMore:document.querySelector(".nextMore-js")},modalTeamRef:{teamModal:document.querySelector(".team-modal"),teamModalBtn:document.querySelector(".tm-close-btn"),teamModalOpen:document.querySelector(".footer-link")},libraryRef:{},galleryRef:{moviesDiv:document.querySelector("#movies-gallery")},filmDetailsRef:{filmDetailsModalOpen:document.querySelector("li"),filmDetailsModal:document.querySelector(".modal"),image:document.querySelector(".js-image"),title:document.querySelector(".js-title"),voteAverage:document.querySelector(".js-vote"),voteCount:document.querySelector(".js-vote-count"),popularity:document.querySelector(".js-popularity"),originTitle:document.querySelector(".js-title-orig"),genres:document.querySelector(".js-genres"),about:document.querySelector(".js-about"),btnWatched:document.querySelector(".js-btn-modal-watched"),btnQueue:document.querySelector(".js-btn-modal-queue")},footerRef:{}}}(async function(){let e;try{const t=await fetch(`https://api.themoviedb.org/3/genre/movie/list?api_key=${API_KEY}`),n=await t.json();e=n.genres}catch(e){console.log(e)}return e})().then((e=>{e.forEach((e=>{o[e.id]=e.name}))}));var c={KEY_WATCHED:"added-watched",KEY_QUEUE:"added-queue"};var d={API_KEY:"06cf6ee022a0922eb5200ae030143d7b",API_BASE_URL:"https://api.themoviedb.org/3/",TRENDING_PATH_PARAMS:"trending/all/day",SEARCH_PATH_PARAMS:"search/movie",DETAILS_PATH_PARAMS:"movie/",IMAGE_BASE_URL:"https://image.tmdb.org/t/p/w1280",GENRES_PATH_PARAMS:"genre/movie/list"};const{API_KEY:l,API_BASE_URL:u,DETAILS_PATH_PARAMS:m}=d;async function g(e){const t=new URL(u+m+e);t.searchParams.set("api_key",l);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return await e.json()}catch(e){console.log(e)}}const p=r().libraryButtonsRef.btnWatched,f=r().libraryButtonsRef.btnQueue,v=document.querySelector(".pagination"),h=document.createElement("div");function _(){f.classList.remove("active"),p.classList.add("active");const e=["453395","921987","667739","616037"];e&&0!==e.length?b(e):h.innerHTML="You don't have any movies you've watched. Add the first one."}function L(){f.classList.add("active"),p.classList.remove("active");const e=["453395","921987","667739","616037"];e&&0!==e.length?b(e):h.innerHTML="You don't have any movies in the queue. Add the first one."}async function b(e){let t=[];for(const i of e){const e=await g(i);if(e){const i=`\n        <article class="movie-card" id="${(n=e).id}">\n        <div class="thumb">\n        <img class="movie-card__img" src="https://image.tmdb.org/t/p/w1280/${n.poster_path}" width="300" sizes="100%" alt="${n.title}"/>\n        </div>\n        <div class="movie-card__description">\n            <p class="movie-card__name">${n.title}</p>\n            <p class="movie-card__info">Genres | ${Number.parseInt(n.release_date)}</p>\n        </div>\n        </article>`;t.push(i)}}var n;t=t.join(""),h.innerHTML=t}h.style.display="flex",v.insertAdjacentElement("beforebegin",h),console.log(h),p.addEventListener("click",_),f.addEventListener("click",L),_(),p.classList.add("active");const{filmDetailsRef:y}=r();document.querySelector(".modal-btn").addEventListener("click",(async function(){const e=await g("496450"),t=d.IMAGE_BASE_URL;e.poster_path||(y.image.src="../images/modal-img.jpg",y.image.alt="Movie photo");y.image.srcset=`${t}${e.poster_path}`,y.image.alt=e.title,y.title.textContent=e.title,y.voteAverage.textContent=e.vote_average,y.voteCount.textContent=e.vote_count,y.popularity.textContent=Number(e.popularity.toFixed(1)),y.originTitle.textContent=e.original_title;let n=e.genres.map((e=>e.name));const i=n.slice(0,2);n.length>2&&i.push("Others");n=i.join(", "),y.genres.textContent=n,y.about.textContent=e.overview}));const{filmDetailsRef:w}=r();var A;function E(e){let n="";const i=e>9?"":"is-hidden";for(let t=1;t<=e&&!(window.matchMedia("(max-width: 767px)").matches&&e>5&&6===t)&&!(e>9&&10===t);t+=1)n+=`<li class="pagination__item js-page" data-num='${t}'><a class="pagination__link" href="#">${t}</a></li>`;return`\n  <ul class="pagination__list pag-list-js">\n      <li class="button prev-js pagination__item"><svg class="button__icon" width="16" height ="16">\n          <use href="${t(A)}#arrow-right"></use>\n        </svg></li>\n      <li class="pagination__item first-js is-hidden hidden"><a class="pagination__link" href="#">1</a></li>\n      <li class="pagination__item prevMore-js is-hidden hidden"><a class="pagination__link" href="#">...</a></li>\n      ${n}\n      <li class="pagination__item ${i} nextMore-js hidden"><a class="pagination__link" href="#">...</a></li>\n      <li class="pagination__item ${i} last-js hidden"><a class="pagination__link" href="#">${e}</a></li>\n      <li class="button next-js pagination__item"><svg class="button__icon" width="16" height="16">\n          <use href="${t(A)}#arrow-left"></use>\n        </svg></li>\n\n    </ul>`}A=new URL(a("kyEFX").resolve("lp5u4"),import.meta.url).toString();const{paginationRef:S}=r();function j(e){const t=E(e);S.container.innerHTML=t}const{API_KEY:M,API_BASE_URL:x,TRENDING_PATH_PARAMS:R}=d;let q,k,T,P=1;function C(e){k=e,e<=1||(j(e),q=r().paginationRef,D(),H(),N(),q.paginationList.addEventListener("click",I))}function I(e){e.preventDefault(),e.target.classList.contains("pagination__item")&&(e.target.classList.contains("js-page")&&(P=Number(e.target.dataset.num)),e.target.classList.contains("prev-js")&&P>1&&(P-=1),e.target.classList.contains("next-js")&&P<k&&(P+=1),e.target.classList.contains("first-js")&&(P=1,$()),e.target.classList.contains("last-js")&&(P=k,$()),e.target.classList.contains("prevMore-js")&&(P=+q.pages[1].dataset.num,$()),e.target.classList.contains("nextMore-js")&&(P=+q.pages[q.pages.length-2].dataset.num,$()),D(),H(),N())}function D(){q.pages.forEach((e=>{e.classList.remove("active"),+e.dataset.num===P&&e.classList.add("active")}))}function H(){window.matchMedia("(min-width: 768px)").matches?k>9&&(P<=5?(q.first.classList.add("is-hidden"),q.prevMore.classList.add("is-hidden"),q.pages[0].classList.remove("is-hidden"),q.pages[1].classList.remove("is-hidden")):(q.first.classList.remove("is-hidden"),q.prevMore.classList.remove("is-hidden"),q.pages[0].classList.add("is-hidden"),q.pages[1].classList.add("is-hidden")),function(){const e=q.pages.length-1;P>=k-4?(q.last.classList.add("is-hidden"),q.nextMore.classList.add("is-hidden"),q.pages[e-1].classList.remove("is-hidden"),q.pages[e].classList.remove("is-hidden")):(q.last.classList.remove("is-hidden"),q.nextMore.classList.remove("is-hidden"),q.pages[e-1].classList.add("is-hidden"),q.pages[e].classList.add("is-hidden"))}(),P>=4&&P<=k&&$()):k>5&&P>=2&&P<=k&&$(),D()}function $(){let e=P-4;P<=1?e=P:P<=2?e=P-1:P<=3?e=P-2:P<=4&&(e=P-3),P>=k?e=P-8:P>=k-1?e=P-7:P>=k-2?e=P-6:P>=k-3&&(e=P-5),window.matchMedia("(max-width: 767px)").matches&&(e=P-2,P<=1?e=P:P<=2&&(e=P-1),P>=k?e=P-4:P>=k-1?e=P-3:P>=k-2&&(e=P-2));for(let t=e,n=0;n<q.pages.length;t+=1,n+=1)q.pages[n].firstElementChild.textContent=t,q.pages[n].dataset.num=t}function N(){P<=1?q.prev.classList.add("disabled"):q.prev.classList.remove("disabled"),P>=k?q.next.classList.add("disabled"):q.next.classList.remove("disabled")}C(200),window.addEventListener("resize",(function(){if(!q)return;window.matchMedia("(max-width: 767px)").matches&&!q.container.classList.contains("mobile-js")?(q.container.classList.remove("desktop-js"),q.container.classList.add("mobile-js"),C(k)):window.matchMedia("(min-width: 768px)").matches&&!q.container.classList.contains("desktop-js")&&(q.container.classList.remove("mobile-js"),q.container.classList.add("desktop-js"),C(k))})),T=r().modalTeamRef,T.teamModalOpen.addEventListener("click",(function(e){function t(){window.removeEventListener("click",i),window.removeEventListener("keydown",n),T.teamModalBtn.removeEventListener("click",s)}function n(e){"Escape"===e.key&&(T.teamModal.classList.add("is-hidden"),t())}function i(e){e.target===T.teamModal&&(T.teamModal.classList.add("is-hidden"),t())}function s(e){T.teamModal.classList.add("is-hidden"),t()}e.preventDefault(),T.teamModal.classList.remove("is-hidden"),window.addEventListener("keydown",n),window.addEventListener("click",i),T.teamModalBtn.addEventListener("click",s)}));const O=c.KEY_WATCHED,U=c.KEY_QUEUE,B=r().filmDetailsRef.btnWatched,Y=r().filmDetailsRef.btnQueue;function K(e){var t;return null!==(t=JSON.parse(localStorage.getItem(e)))&&void 0!==t?t:[]}function Q(e,t){const n=K(e);console.log(n),n.push(t),localStorage.setItem(e,JSON.stringify(n))}function W(e,t){const n=K(e),i=n.indexOf(t);console.log(i),n.splice(i,1),localStorage.setItem(e,JSON.stringify(n))}var F;function G(e){K(O).includes(e)?(B.setAttribute("actions","added"),B.classList.add("active"),B.textContent="Remove from Watched"):(B.setAttribute("actions","not-added"),B.classList.remove("active"),B.textContent="Add to Watched")}function J(e){K(U).includes(e)?(Y.setAttribute("actions","added"),Y.classList.add("active"),Y.textContent="Remove from Queue"):(Y.setAttribute("actions","not-added"),Y.classList.remove("active"),Y.textContent="Add to Queue")}function X(e){const t=e.currentTarget.getAttribute("id");console.log(B.getAttribute("actions")),"added"===B.getAttribute("actions")?(console.log("delete"),W(O,t)):(Q(O,t),W(U,t)),G(t),J(t)}function z(e){const t=e.currentTarget.getAttribute("id");"added"===Y.getAttribute("actions")?W(U,t):(Q(U,t),W(O,t)),G(t),J(t)}G(F="921987"),J(F),B.setAttribute("id",F),B.addEventListener("click",X),Y.setAttribute("id",F),Y.addEventListener("click",z);
//# sourceMappingURL=index.b06e6de5.js.map
