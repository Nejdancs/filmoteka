function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},s={},i=n.parcelRequired76b;null==i&&((i=function(e){if(e in a)return a[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){s[e]=t},n.parcelRequired76b=i),i.register("kyEFX",(function(t,n){var a,s;e(t.exports,"register",(function(){return a}),(function(e){return a=e})),e(t.exports,"resolve",(function(){return s}),(function(e){return s=e}));var i={};a=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)i[t[n]]=e[t[n]]},s=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),i("kyEFX").register(JSON.parse('{"5ZPII":"index.fbf779e4.js","lp5u4":"sprite.b12e0b11.svg"}'));var r={API_KEY:"06cf6ee022a0922eb5200ae030143d7b",API_BASE_URL:"https://api.themoviedb.org/3/",TRENDING_PATH_PARAMS:"trending/all/day",SEARCH_PATH_PARAMS:"search/movie",DETAILS_PATH_PARAMS:"movie/",IMAGE_BASE_URL:"https://image.tmdb.org/t/p/w1280",GENRES_PATH_PARAMS:"genre/movie/list"};const{API_KEY:o,API_BASE_URL:c,GENRES_PATH_PARAMS:l}=r;const d={};function u(e){const t=[];e.genre_ids.forEach((e=>{d[e]&&t.push(d[e])})),0===t.length&&t.push("N/A"),t.length>3&&(t.splice(3),t[2]="Other");return t.map((e=>`${e}`)).join(", ")}(async function(){const e=new URL(c+l);e.searchParams.set("api_key",o);try{const t=await fetch(e);if(!t.ok){const e=await t.json();throw new Error(e.status_message)}return await t.json()}catch(e){console.log(e)}})().then((e=>{e.genres.forEach((e=>{d[e.id]=e.name}))}));const{API_KEY:m,API_BASE_URL:f,TRENDING_PATH_PARAMS:g}=r;async function h(e=1){const t=new URL(f+g);t.searchParams.set("api_key",m),t.searchParams.set("page",e);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return await e.json()}catch(e){console.log(e)}}function p(){return{headerRef:{header:document.querySelector(".header"),navLogo:document.querySelector(".navigation__logo"),searchForm:document.querySelector(".js-search-form"),headLibBackGr:document.querySelector(".header--library"),searchInput:document.querySelector(".js-form-input")},searchRef:{searchForm:document.querySelector(".search-form")},libraryButtonsRef:{btnContainer:document.querySelector(".js-btn-container"),btnWatched:document.querySelector(".js-btn-watched"),btnQueue:document.querySelector(".js-btn-queue")},paginationRef:{container:document.querySelector(".pag-container-js"),paginationList:document.querySelector(".pag-list-js"),pages:document.querySelectorAll(".js-page"),prev:document.querySelector(".prev-js"),next:document.querySelector(".next-js"),first:document.querySelector(".first-js"),last:document.querySelector(".last-js"),prevMore:document.querySelector(".prevMore-js"),nextMore:document.querySelector(".nextMore-js")},modalTeamRef:{teamModal:document.querySelector(".team-modal"),teamModalBtn:document.querySelector(".tm-close-btn"),teamModalOpen:document.querySelector(".footer-link")},libraryRef:{libBtn:document.querySelector(".js-library"),homeBtn:document.querySelector(".js-home")},galleryRef:{moviesDiv:document.querySelector("#movies-gallery")},filmDetailsRef:{filmDetailsModalOpen:document.querySelector("li"),filmDetailsModal:document.querySelector(".modal"),image:document.querySelector(".js-image"),title:document.querySelector(".js-title"),voteAverage:document.querySelector(".js-vote"),voteCount:document.querySelector(".js-vote-count"),popularity:document.querySelector(".js-popularity"),originTitle:document.querySelector(".js-title-orig"),genres:document.querySelector(".js-genres"),about:document.querySelector(".js-about"),btnWatched:document.querySelector(".js-btn-modal-watched"),btnQueue:document.querySelector(".js-btn-modal-queue")},footerRef:{},loaderRef:{loader:document.querySelector(".js-loader")},modalErrorRef:{modalError:document.querySelector(".windov-modal"),modalErrorText:document.querySelector(".error-modal__text")}}}function v(){p().loaderRef.loader.classList.add("is-hidden")}function _(){p().loaderRef.loader.classList.remove("is-hidden")}const{IMAGE_BASE_URL:y}=r;function L(e,t,n){const a=e.name||e.original_title;return`<li class="gallery-card" data-id ="${e.id}">\n<a href="#" class="gallery-card__link">\n            <img src="${y+e.poster_path}" alt="${e.original_title}"  class="gallery-card__image" >\n  <div class="gallery-card__info">\n<p class="gallery-card__name">${a}</p>\n<p class="gallery-card__genre">${t} | ${n}</p>\n</div>\n</a>\n\t    </li>`}const{moviesDiv:b}=p().galleryRef;function E(e){const t=e.results.map((e=>function(e){const t=u(e);let n;n=e.release_date?Number.parseInt(e.release_date):Number.parseInt(e.first_air_date);return L(e,t,n)}(e))).join("");b.innerHTML=`<ul class="gallery-container">${t}</ul>`}var w={KEY_WATCHED:"added-watched",KEY_QUEUE:"added-queue"};const{API_KEY:R,API_BASE_URL:A,DETAILS_PATH_PARAMS:S}=r;async function j(e){const t=new URL(A+S+e);t.searchParams.set("api_key",R);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return await e.json()}catch(e){console.log(e)}}const{IMAGE_BASE_URL:M}=r;function q(e){let t=e.genres.map((e=>e.name));return t.length>3&&(t=[t[0],t[1],"Other"].join(", ")),`\n  <li class="gallery-card" data-id ="${e.id}">\n    <a href="#" class="gallery-card__item">\n      <img src="${M+e.poster_path}" alt="${e.title}"  class="gallery-card__image" >\n      <div class="gallery-card__info">\n        <p class="gallery-card__name">${e.title}</p>\n        <p class="gallery-card__genre">${t} | ${Number.parseInt(e.release_date)}\n        </p>\n      </div>\n    </a>        \n\t</li>`}var x;function k(e){let n="";const a=e>9?"":"is-hidden";for(let t=1;t<=e&&!(window.matchMedia("(max-width: 767px)").matches&&e>5&&6===t)&&!(e>9&&10===t);t+=1)n+=`<li class="pagination__item js-page" data-num='${t}'><a class="pagination__link" href="#">${t}</a></li>`;return`\n  <ul class="pagination__list pag-list-js">\n      <li class="button prev-js pagination__item"><svg class="button__icon" width="16" height ="16">\n          <use href="${t(x)}#arrow-right"></use>\n        </svg></li>\n      <li class="pagination__item first-js is-hidden hidden"><a class="pagination__link" href="#">1</a></li>\n      <li class="pagination__item prevMore-js is-hidden hidden"><a class="pagination__link" href="#">...</a></li>\n      ${n}\n      <li class="pagination__item ${a} nextMore-js hidden"><a class="pagination__link" href="#">...</a></li>\n      <li class="pagination__item ${a} last-js hidden"><a class="pagination__link" href="#">${e}</a></li>\n      <li class="button next-js pagination__item"><svg class="button__icon" width="16" height="16">\n          <use href="${t(x)}#arrow-left"></use>\n        </svg></li>\n\n    </ul>`}x=new URL(i("kyEFX").resolve("lp5u4"),import.meta.url).toString();const{paginationRef:P}=p();function T(e){const t=k(e);P.container.innerHTML=t}let I,B,$=1;function C(e){B=e,e<=1||(T(e),I=p().paginationRef,D(),U(),O(),I.paginationList.addEventListener("click",H))}function H(e){e.preventDefault(),e.target.classList.contains("pagination__item")&&(e.target.classList.contains("js-page")&&($=Number(e.target.dataset.num)),e.target.classList.contains("prev-js")&&$>1&&($-=1),e.target.classList.contains("next-js")&&$<B&&($+=1),e.target.classList.contains("first-js")&&($=1,N()),e.target.classList.contains("last-js")&&($=B,N()),e.target.classList.contains("prevMore-js")&&($=+I.pages[1].dataset.num,N()),e.target.classList.contains("nextMore-js")&&($=+I.pages[I.pages.length-2].dataset.num,N()),D(),U(),O())}function D(){I.pages.forEach((e=>{e.classList.remove("active"),+e.dataset.num===$&&e.classList.add("active")}))}function U(){window.matchMedia("(min-width: 768px)").matches?B>9&&($<=5?(I.first.classList.add("is-hidden"),I.prevMore.classList.add("is-hidden"),I.pages[0].classList.remove("is-hidden"),I.pages[1].classList.remove("is-hidden")):(I.first.classList.remove("is-hidden"),I.prevMore.classList.remove("is-hidden"),I.pages[0].classList.add("is-hidden"),I.pages[1].classList.add("is-hidden")),function(){const e=I.pages.length-1;$>=B-4?(I.last.classList.add("is-hidden"),I.nextMore.classList.add("is-hidden"),I.pages[e-1].classList.remove("is-hidden"),I.pages[e].classList.remove("is-hidden")):(I.last.classList.remove("is-hidden"),I.nextMore.classList.remove("is-hidden"),I.pages[e-1].classList.add("is-hidden"),I.pages[e].classList.add("is-hidden"))}(),$>=4&&$<=B&&N()):B>5&&$>=2&&$<=B&&N(),D()}function N(){let e=$-4;$<=1?e=$:$<=2?e=$-1:$<=3?e=$-2:$<=4&&(e=$-3),$>=B?e=$-8:$>=B-1?e=$-7:$>=B-2?e=$-6:$>=B-3&&(e=$-5),window.matchMedia("(max-width: 767px)").matches&&(e=$-2,$<=1?e=$:$<=2&&(e=$-1),$>=B?e=$-4:$>=B-1?e=$-3:$>=B-2&&(e=$-2));for(let t=e,n=0;n<I.pages.length;t+=1,n+=1)I.pages[n].firstElementChild.textContent=t,I.pages[n].dataset.num=t}function O(){$<=1?I.prev.classList.add("disabled"):I.prev.classList.remove("disabled"),$>=B?I.next.classList.add("disabled"):I.next.classList.remove("disabled")}window.addEventListener("resize",(function(){if(!I)return;window.matchMedia("(max-width: 767px)").matches&&!I.container.classList.contains("mobile-js")?(I.container.classList.remove("desktop-js"),I.container.classList.add("mobile-js"),C(B)):window.matchMedia("(min-width: 768px)").matches&&!I.container.classList.contains("desktop-js")&&(I.container.classList.remove("mobile-js"),I.container.classList.add("desktop-js"),C(B))}));const F=p().libraryButtonsRef.btnWatched,Y=p().libraryButtonsRef.btnQueue,G=p().galleryRef.moviesDiv;let K;function Q(){F.addEventListener("click",W),Y.addEventListener("click",J),W(),F.classList.add("active")}async function W(){Y.classList.remove("active"),F.classList.add("active"),G.innerHTML="";const e=["453395","921987","667739","616037","507086","453395","616037","120011","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636","453395","921987","667739","616037","507086","453395","616037","120111","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636","111277","667739","616037","507086","453395","616037","120011","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636","453395","921987","667739","616037","507086","453395","616037","120111","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636"];e&&0!==e.length?(K=await Promise.all(X(e)),K=K.filter((e=>void 0!==e)),z(),C(K/20)):G.innerHTML="You don't have any movies you've watched. Add the first one."}async function J(){Y.classList.add("active"),F.classList.remove("active"),G.innerHTML="";const e=["453395","921987","667739","616037","507086","453395","616037","120011","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636","453395","921987","667739","616037","507086","453395","616037","120111","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636","111277","667739","616037","507086","453395","616037","120011","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636","453395","921987","667739","616037","507086","453395","616037","120111","759175","438148","745376","92782","102903","76479","361743","545611","63247","64196","634649","204852","72636"];console.log(e),e&&0!==e.length?(K=await Promise.all(X(e)),K=K.filter((e=>void 0!==e)),console.log(K),z(),C(K/20)):G.innerHTML="You don't have any movies in the queue. Add the first one."}function X(e){return e.map((e=>new Promise((t=>{t(j(e)),reject(j(e))}))))}function z(e=1){arrayForPage=K.slice(0+20*(e-1),20+20*(e-1));const t=arrayForPage.map((e=>{if(e)return q(e)})).join("");G.innerHTML=`<ul class="gallery-container">${t}</ul>`}async function Z(){_();const e=await h();console.log(e),E(e),C(e.total_pages),v()}function V(){p().headerRef.searchInput.value=null,p().headerRef.header.classList.add("header--home"),p().headerRef.header.classList.remove("header--library"),p().libraryButtonsRef.btnContainer.classList.add("display-none"),p().headerRef.searchForm.classList.remove("display-none"),p().libraryRef.homeBtn.classList.add("current"),p().libraryRef.libBtn.classList.remove("current"),Z()}_(),window.addEventListener("DOMContentLoaded",Z),p().libraryRef.homeBtn.addEventListener("click",V),p().libraryRef.libBtn.addEventListener("click",(function(){p().headerRef.header.classList.remove("header--home"),p().headerRef.header.classList.add("header--library"),p().headerRef.searchForm.classList.add("display-none"),p().libraryButtonsRef.btnContainer.classList.remove("display-none"),p().libraryRef.libBtn.classList.add("current"),p().libraryRef.homeBtn.classList.remove("current"),p().paginationRef.container.classList.add("display-none"),Q()})),p().headerRef.navLogo.addEventListener("click",V);const{API_KEY:ee,API_BASE_URL:te,SEARCH_PATH_PARAMS:ne}=r;async function ae(e,t=1){const n=new URL(te+ne);n.searchParams.set("api_key",ee),n.searchParams.set("page",t),n.searchParams.set("query",e);try{const e=await fetch(n);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}const t=await e.json();if(t.results.length)return t;throw new Error("Nothing is found. Wrong query.")}catch(e){console.log(e)}}const{moviesDiv:se}=p().galleryRef,{searchForm:ie}=p().searchRef,{modalError:re}=p().modalErrorRef,{modalErrorText:oe}=p().modalErrorRef;let ce="",le=null;function de(){re.classList.add("is-hidden")}ie.addEventListener("submit",(function(e){if(e.preventDefault(),ce=e.target.elements.searchQuery.value.trim(),console.log(ce),""===ce){return function(e){re.classList.remove("is-hidden"),function(e){oe.innerHTML=`${e}`}(e),le=setTimeout((()=>{de()}),3e3)}("Enter the name of the movie, for a correct search!")}_(),page=1,se.innerHTML="",ae(ce).then((e=>{e?E(e):alert("плохой запрос")})).finally(v)})),re.addEventListener("click",(function(){de(),clearInterval(le)}));const{filmDetailsRef:ue}=p();document.querySelector(".modal-btn").addEventListener("click",(async function(){const e=await j("496450"),t=r.IMAGE_BASE_URL;e.poster_path||(ue.image.src="../images/modal-img.jpg",ue.image.alt="Movie photo");ue.image.srcset=`${t}${e.poster_path}`,ue.image.alt=e.title,ue.title.textContent=e.title,ue.voteAverage.textContent=e.vote_average,ue.voteCount.textContent=e.vote_count,ue.popularity.textContent=Number(e.popularity.toFixed(1)),ue.originTitle.textContent=e.original_title;let n=e.genres.map((e=>e.name));const a=n.slice(0,2);n.length>2&&a.push("Others");n=a.join(", "),ue.genres.textContent=n,ue.about.textContent=e.overview}));const{filmDetailsRef:me}=p();let fe;fe=p().modalTeamRef,fe.teamModalOpen.addEventListener("click",(function(e){function t(){window.removeEventListener("click",a),window.removeEventListener("keydown",n),fe.teamModalBtn.removeEventListener("click",s)}function n(e){"Escape"===e.key&&(fe.teamModal.classList.add("is-hidden"),t())}function a(e){e.target===fe.teamModal&&(fe.teamModal.classList.add("is-hidden"),t())}function s(e){fe.teamModal.classList.add("is-hidden"),t()}e.preventDefault(),fe.teamModal.classList.remove("is-hidden"),window.addEventListener("keydown",n),window.addEventListener("click",a),fe.teamModalBtn.addEventListener("click",s)}));const ge=w.KEY_WATCHED,he=w.KEY_QUEUE,pe=p().filmDetailsRef.btnWatched,ve=p().filmDetailsRef.btnQueue;function _e(e){var t;return null!==(t=JSON.parse(localStorage.getItem(e)))&&void 0!==t?t:[]}function ye(e,t){const n=_e(e);console.log(n),n.push(t),localStorage.setItem(e,JSON.stringify(n))}function Le(e,t){const n=_e(e),a=n.indexOf(t);console.log(a),n.splice(a,1),localStorage.setItem(e,JSON.stringify(n))}var be;function Ee(e){_e(ge).includes(e)?(pe.setAttribute("actions","added"),pe.classList.add("active"),pe.textContent="Remove from Watched"):(pe.setAttribute("actions","not-added"),pe.classList.remove("active"),pe.textContent="Add to Watched")}function we(e){_e(he).includes(e)?(ve.setAttribute("actions","added"),ve.classList.add("active"),ve.textContent="Remove from Queue"):(ve.setAttribute("actions","not-added"),ve.classList.remove("active"),ve.textContent="Add to Queue")}function Re(e){const t=e.currentTarget.getAttribute("id");console.log(pe.getAttribute("actions")),"added"===pe.getAttribute("actions")?(console.log("delete"),Le(ge,t)):(ye(ge,t),Le(he,t)),Ee(t),we(t)}function Ae(e){const t=e.currentTarget.getAttribute("id");"added"===ve.getAttribute("actions")?Le(he,t):(ye(he,t),Le(ge,t)),Ee(t),we(t)}Ee(be="921987"),we(be),pe.setAttribute("id",be),pe.addEventListener("click",Re),ve.setAttribute("id",be),ve.addEventListener("click",Ae);
//# sourceMappingURL=index.fbf779e4.js.map
