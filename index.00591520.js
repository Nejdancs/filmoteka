function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},s={},i=n.parcelRequired76b;null==i&&((i=function(e){if(e in a)return a[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){s[e]=t},n.parcelRequired76b=i),i.register("kyEFX",(function(t,n){var a,s;e(t.exports,"register",(function(){return a}),(function(e){return a=e})),e(t.exports,"resolve",(function(){return s}),(function(e){return s=e}));var i={};a=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)i[t[n]]=e[t[n]]},s=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),i("kyEFX").register(JSON.parse('{"5ZPII":"index.00591520.js","lp5u4":"sprite.b12e0b11.svg"}'));
//!!!!!!!!! ОБЕ функции надо вызывать при старте
const o={};(async function(){let e;try{const t=await fetch(`https://api.themoviedb.org/3/genre/movie/list?api_key=${API_KEY}`),n=await t.json();e=n.genres}catch(e){console.log(e)}return e})().then((e=>{e.forEach((e=>{o[e.id]=e.name}))}));var r={API_KEY:"06cf6ee022a0922eb5200ae030143d7b",API_BASE_URL:"https://api.themoviedb.org/3/",TRENDING_PATH_PARAMS:"trending/all/day",SEARCH_PATH_PARAMS:"search/movie",DETAILS_PATH_PARAMS:"movie/",IMAGE_BASE_URL:"https://image.tmdb.org/t/p/w1280",GENRES_PATH_PARAMS:"genre/movie/list"};const{API_KEY:c,API_BASE_URL:l,TRENDING_PATH_PARAMS:d}=r;async function u(e=1){const t=new URL(l+d);t.searchParams.set("api_key",c),t.searchParams.set("page",e);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return(await e.json()).results}catch(e){console.log(e)}}function m(){return{headerRef:{header:document.querySelector(".header"),navLogo:document.querySelector(".navigation__logo"),searchForm:document.querySelector(".js-search-form"),headLibBackGr:document.querySelector(".header--library"),searchInput:document.querySelector(".js-form-input")},homeRef:{},libraryButtonsRef:{btnContainer:document.querySelector(".js-btn-container"),btnWatched:document.querySelector(".js-btn-watched"),btnQueue:document.querySelector(".js-btn-queue")},paginationRef:{container:document.querySelector(".pag-container-js"),paginationList:document.querySelector(".pag-list-js"),pages:document.querySelectorAll(".js-page"),prev:document.querySelector(".prev-js"),next:document.querySelector(".next-js"),first:document.querySelector(".first-js"),last:document.querySelector(".last-js"),prevMore:document.querySelector(".prevMore-js"),nextMore:document.querySelector(".nextMore-js")},modalTeamRef:{teamModal:document.querySelector(".team-modal"),teamModalBtn:document.querySelector(".tm-close-btn"),teamModalOpen:document.querySelector(".footer-link")},libraryRef:{libBtn:document.querySelector(".js-library"),homeBtn:document.querySelector(".js-home")},galleryRef:{moviesDiv:document.querySelector("#movies-gallery")},filmDetailsRef:{filmDetailsModalOpen:document.querySelector("li"),filmDetailsModal:document.querySelector(".modal"),image:document.querySelector(".js-image"),title:document.querySelector(".js-title"),voteAverage:document.querySelector(".js-vote"),voteCount:document.querySelector(".js-vote-count"),popularity:document.querySelector(".js-popularity"),originTitle:document.querySelector(".js-title-orig"),genres:document.querySelector(".js-genres"),about:document.querySelector(".js-about"),btnWatched:document.querySelector(".js-btn-modal-watched"),btnQueue:document.querySelector(".js-btn-modal-queue")},footerRef:{},loaderRef:{loader:document.querySelector(".loader")}}}async function g(){const e=(await getPopularMovies()).results.map((e=>function(e){const t=[];e.genre_ids.forEach((e=>{genresList[e]&&t.push(genresList[e])})),0===t.length&&t.push("N/A");t.length>3&&(t.splice(3),t[2]="Other");const n=t.map((e=>`${e}`)).join(", ");let a;a=e.release_date?Number.parseInt(e.release_date):Number.parseInt(e.first_air_date);return e.name?`<li class="gallery-card" data-id ="${e.id}">\n<a class="gallery-card__item">\n            <img src="${IMAGE_BASE_URL+e.poster_path}" alt="${e.original_title}"  class="gallery-card__image" >\n<p class="gallery-card__name">${e.name}</p>\n<p class="gallery-card__genre">${n} | ${a}<span class="gallery-card__span"></span></p>\n</a>        \n\t    </li>`:`<li class="gallery-card" data-id ="${e.id}">\n<a class="gallery-card__item">\n            <img src="${IMAGE_BASE_URL+e.poster_path}" alt="${e.original_title}"  class="gallery-card__image" >\n<p class="gallery-card__name">${e.original_title}</p>\n<p class="gallery-card__genre">${n} | ${a}<span class="gallery-card__span"></span></p>\n</a>\n            </li>`}(e))).join("");m.moviesDiv.innerHTML=`<ul class="gallery-container">${e}</ul>`}function p(){m().headerRef.searchInput.value=null,m().headerRef.header.classList.add("header--home"),m().headerRef.header.classList.remove("header--library"),m().libraryButtonsRef.btnContainer.classList.add("display-none"),m().headerRef.searchForm.classList.remove("display-none"),m().libraryRef.homeBtn.classList.add("current"),m().libraryRef.libBtn.classList.remove("current")}m().loaderRef.loader.classList.remove("is-hidden"),window.addEventListener("DOMContentLoaded",(async function(){g(await u()),m().loaderRef.loader.classList.add("is-hidden")})),m().libraryRef.homeBtn.addEventListener("click",p),m().libraryRef.libBtn.addEventListener("click",(function(){m().headerRef.header.classList.remove("header--home"),m().headerRef.header.classList.add("header--library"),m().headerRef.searchForm.classList.add("display-none"),m().libraryButtonsRef.btnContainer.classList.remove("display-none"),m().libraryRef.libBtn.classList.add("current"),m().libraryRef.homeBtn.classList.remove("current"),m().paginationRef.container.classList.add("display-none")})),m().headerRef.navLogo.addEventListener("click",p);var h={KEY_WATCHED:"added-watched",KEY_QUEUE:"added-queue"};const{API_KEY:f,API_BASE_URL:v,DETAILS_PATH_PARAMS:_}=r;async function y(e){const t=new URL(v+_+e);t.searchParams.set("api_key",f);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return await e.json()}catch(e){console.log(e)}}const L=m().libraryButtonsRef.btnWatched,b=m().libraryButtonsRef.btnQueue,w=document.querySelector(".pagination"),S=document.createElement("div");function E(){b.classList.remove("active"),L.classList.add("active");const e=["453395","921987","667739","616037"];e&&0!==e.length?A(e):S.innerHTML="You don't have any movies you've watched. Add the first one."}function R(){b.classList.add("active"),L.classList.remove("active");const e=["453395","921987","667739","616037"];e&&0!==e.length?A(e):S.innerHTML="You don't have any movies in the queue. Add the first one."}async function A(e){let t=[];for(const a of e){const e=await y(a);if(e){const a=`\n        <article class="movie-card" id="${(n=e).id}">\n        <div class="thumb">\n        <img class="movie-card__img" src="https://image.tmdb.org/t/p/w1280/${n.poster_path}" width="300" sizes="100%" alt="${n.title}"/>\n        </div>\n        <div class="movie-card__description">\n            <p class="movie-card__name">${n.title}</p>\n            <p class="movie-card__info">Genres | ${Number.parseInt(n.release_date)}</p>\n        </div>\n        </article>`;t.push(a)}}var n;t=t.join(""),S.innerHTML=t}S.style.display="flex",w.insertAdjacentElement("beforebegin",S),console.log(S),L.addEventListener("click",E),b.addEventListener("click",R),E(),L.classList.add("active");const{filmDetailsRef:j}=m();document.querySelector(".modal-btn").addEventListener("click",(async function(){const e=await y("496450"),t=r.IMAGE_BASE_URL;e.poster_path||(j.image.src="../images/modal-img.jpg",j.image.alt="Movie photo");j.image.srcset=`${t}${e.poster_path}`,j.image.alt=e.title,j.title.textContent=e.title,j.voteAverage.textContent=e.vote_average,j.voteCount.textContent=e.vote_count,j.popularity.textContent=Number(e.popularity.toFixed(1)),j.originTitle.textContent=e.original_title;let n=e.genres.map((e=>e.name));const a=n.slice(0,2);n.length>2&&a.push("Others");n=a.join(", "),j.genres.textContent=n,j.about.textContent=e.overview}));const{filmDetailsRef:M}=m();var q;function x(e){let n="";const a=e>9?"":"is-hidden";for(let t=1;t<=e&&!(window.matchMedia("(max-width: 767px)").matches&&e>5&&6===t)&&!(e>9&&10===t);t+=1)n+=`<li class="pagination__item js-page" data-num='${t}'><a class="pagination__link" href="#">${t}</a></li>`;return`\n  <ul class="pagination__list pag-list-js">\n      <li class="button prev-js pagination__item"><svg class="button__icon" width="16" height ="16">\n          <use href="${t(q)}#arrow-right"></use>\n        </svg></li>\n      <li class="pagination__item first-js is-hidden hidden"><a class="pagination__link" href="#">1</a></li>\n      <li class="pagination__item prevMore-js is-hidden hidden"><a class="pagination__link" href="#">...</a></li>\n      ${n}\n      <li class="pagination__item ${a} nextMore-js hidden"><a class="pagination__link" href="#">...</a></li>\n      <li class="pagination__item ${a} last-js hidden"><a class="pagination__link" href="#">${e}</a></li>\n      <li class="button next-js pagination__item"><svg class="button__icon" width="16" height="16">\n          <use href="${t(q)}#arrow-left"></use>\n        </svg></li>\n\n    </ul>`}q=new URL(i("kyEFX").resolve("lp5u4"),import.meta.url).toString();const{paginationRef:k}=m();function $(e){const t=x(e);k.container.innerHTML=t}let I,T,P,B=1;function C(e){T=e,e<=1||($(e),I=m().paginationRef,N(),H(),U(),I.paginationList.addEventListener("click",D))}function D(e){e.preventDefault(),e.target.classList.contains("pagination__item")&&(e.target.classList.contains("js-page")&&(B=Number(e.target.dataset.num)),e.target.classList.contains("prev-js")&&B>1&&(B-=1),e.target.classList.contains("next-js")&&B<T&&(B+=1),e.target.classList.contains("first-js")&&(B=1,O()),e.target.classList.contains("last-js")&&(B=T,O()),e.target.classList.contains("prevMore-js")&&(B=+I.pages[1].dataset.num,O()),e.target.classList.contains("nextMore-js")&&(B=+I.pages[I.pages.length-2].dataset.num,O()),N(),H(),U())}function N(){I.pages.forEach((e=>{e.classList.remove("active"),+e.dataset.num===B&&e.classList.add("active")}))}function H(){window.matchMedia("(min-width: 768px)").matches?T>9&&(B<=5?(I.first.classList.add("is-hidden"),I.prevMore.classList.add("is-hidden"),I.pages[0].classList.remove("is-hidden"),I.pages[1].classList.remove("is-hidden")):(I.first.classList.remove("is-hidden"),I.prevMore.classList.remove("is-hidden"),I.pages[0].classList.add("is-hidden"),I.pages[1].classList.add("is-hidden")),function(){const e=I.pages.length-1;B>=T-4?(I.last.classList.add("is-hidden"),I.nextMore.classList.add("is-hidden"),I.pages[e-1].classList.remove("is-hidden"),I.pages[e].classList.remove("is-hidden")):(I.last.classList.remove("is-hidden"),I.nextMore.classList.remove("is-hidden"),I.pages[e-1].classList.add("is-hidden"),I.pages[e].classList.add("is-hidden"))}(),B>=4&&B<=T&&O()):T>5&&B>=2&&B<=T&&O(),N()}function O(){let e=B-4;B<=1?e=B:B<=2?e=B-1:B<=3?e=B-2:B<=4&&(e=B-3),B>=T?e=B-8:B>=T-1?e=B-7:B>=T-2?e=B-6:B>=T-3&&(e=B-5),window.matchMedia("(max-width: 767px)").matches&&(e=B-2,B<=1?e=B:B<=2&&(e=B-1),B>=T?e=B-4:B>=T-1?e=B-3:B>=T-2&&(e=B-2));for(let t=e,n=0;n<I.pages.length;t+=1,n+=1)I.pages[n].firstElementChild.textContent=t,I.pages[n].dataset.num=t}function U(){B<=1?I.prev.classList.add("disabled"):I.prev.classList.remove("disabled"),B>=T?I.next.classList.add("disabled"):I.next.classList.remove("disabled")}function F(e){const t=localStorage.getItem(e);try{return JSON.parse(t)}catch(e){console.log(e)}}C(200),window.addEventListener("resize",(function(){if(!I)return;window.matchMedia("(max-width: 767px)").matches&&!I.container.classList.contains("mobile-js")?(I.container.classList.remove("desktop-js"),I.container.classList.add("mobile-js"),C(T)):window.matchMedia("(min-width: 768px)").matches&&!I.container.classList.contains("desktop-js")&&(I.container.classList.remove("mobile-js"),I.container.classList.add("desktop-js"),C(T))})),P=m().modalTeamRef,P.teamModalOpen.addEventListener("click",(function(e){function t(){window.removeEventListener("click",a),window.removeEventListener("keydown",n),P.teamModalBtn.removeEventListener("click",s)}function n(e){"Escape"===e.key&&(P.teamModal.classList.add("is-hidden"),t())}function a(e){e.target===P.teamModal&&(P.teamModal.classList.add("is-hidden"),t())}function s(e){P.teamModal.classList.add("is-hidden"),t()}e.preventDefault(),P.teamModal.classList.remove("is-hidden"),window.addEventListener("keydown",n),window.addEventListener("click",a),P.teamModalBtn.addEventListener("click",s)})),function(e,t){const n=F(e);let a=[];n?a=[...n,t]:a.push(t),localStorage.setItem(e,JSON.stringify(t))}();const Y=h.KEY_WATCHED,G=h.KEY_QUEUE,K=m().filmDetailsRef.btnWatched,Q=m().filmDetailsRef.btnQueue;function W(e){var t;return null!==(t=JSON.parse(localStorage.getItem(e)))&&void 0!==t?t:[]}function J(e,t){const n=W(e);console.log(n),n.push(t),localStorage.setItem(e,JSON.stringify(n))}function X(e,t){const n=W(e),a=n.indexOf(t);console.log(a),n.splice(a,1),localStorage.setItem(e,JSON.stringify(n))}var z;function Z(e){W(Y).includes(e)?(K.setAttribute("actions","added"),K.classList.add("active"),K.textContent="Remove from Watched"):(K.setAttribute("actions","not-added"),K.classList.remove("active"),K.textContent="Add to Watched")}function V(e){W(G).includes(e)?(Q.setAttribute("actions","added"),Q.classList.add("active"),Q.textContent="Remove from Queue"):(Q.setAttribute("actions","not-added"),Q.classList.remove("active"),Q.textContent="Add to Queue")}function ee(e){const t=e.currentTarget.getAttribute("id");console.log(K.getAttribute("actions")),"added"===K.getAttribute("actions")?(console.log("delete"),X(Y,t)):(J(Y,t),X(G,t)),Z(t),V(t)}function te(e){const t=e.currentTarget.getAttribute("id");"added"===Q.getAttribute("actions")?X(G,t):(J(G,t),X(Y,t)),Z(t),V(t)}Z(z="921987"),V(z),K.setAttribute("id",z),K.addEventListener("click",ee),Q.setAttribute("id",z),Q.addEventListener("click",te);
//# sourceMappingURL=index.00591520.js.map
