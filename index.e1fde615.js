function e(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},s={},i=n.parcelRequired76b;null==i&&((i=function(e){if(e in a)return a[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return a[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){s[e]=t},n.parcelRequired76b=i),i.register("kyEFX",(function(t,n){var a,s;e(t.exports,"register",(function(){return a}),(function(e){return a=e})),e(t.exports,"resolve",(function(){return s}),(function(e){return s=e}));var i={};a=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)i[t[n]]=e[t[n]]},s=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),i("kyEFX").register(JSON.parse('{"5ZPII":"index.e1fde615.js","9Q6Xn":"img-default@1x.79d493e0.jpg","6Auof":"img-default@2x.bbc4c791.jpg","lp5u4":"sprite.b12e0b11.svg"}'));var o={API_KEY:"06cf6ee022a0922eb5200ae030143d7b",API_BASE_URL:"https://api.themoviedb.org/3/",TRENDING_PATH_PARAMS:"trending/all/day",SEARCH_PATH_PARAMS:"search/movie",DETAILS_PATH_PARAMS:"movie/",IMAGE_BASE_URL_1X:"https://image.tmdb.org/t/p/w500",IMAGE_BASE_URL_2X:"https://image.tmdb.org/t/p/w780",GENRES_PATH_PARAMS:"genre/movie/list"};const{API_KEY:r,API_BASE_URL:c,GENRES_PATH_PARAMS:l}=o;const d={};function u(e){const t=[];e.genre_ids?e.genre_ids.forEach((e=>{d[e]&&t.push(d[e])})):t.push("N/A"),0===t.length&&t.push("N/A"),t.length>3&&(t.splice(3),t[2]="Other");return t.map((e=>`${e}`)).join(", ")}(async function(){const e=new URL(c+l);e.searchParams.set("api_key",r);try{const t=await fetch(e);if(!t.ok){const e=await t.json();throw new Error(e.status_message)}return await t.json()}catch(e){console.log(e)}})().then((e=>{e.genres.forEach((e=>{d[e.id]=e.name}))}));const{API_KEY:m,API_BASE_URL:f,TRENDING_PATH_PARAMS:g}=o;async function h(e=1){const t=new URL(f+g);t.searchParams.set("api_key",m),t.searchParams.set("page",e);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return await e.json()}catch(e){console.log(e)}}function p(){return{headerRef:{header:document.querySelector(".header"),navLogo:document.querySelector(".navigation__logo"),searchForm:document.querySelector(".js-search-form"),headLibBackGr:document.querySelector(".header--library"),searchInput:document.querySelector(".js-form-input")},searchRef:{searchForm:document.querySelector(".search-form")},libraryButtonsRef:{btnContainer:document.querySelector(".js-btn-container"),btnWatched:document.querySelector(".js-btn-watched"),btnQueue:document.querySelector(".js-btn-queue")},paginationRef:{container:document.querySelector(".pag-container-js"),paginationList:document.querySelector(".pag-list-js"),pages:document.querySelectorAll(".js-page"),prev:document.querySelector(".prev-js"),next:document.querySelector(".next-js"),first:document.querySelector(".first-js"),last:document.querySelector(".last-js"),prevMore:document.querySelector(".prevMore-js"),nextMore:document.querySelector(".nextMore-js")},modalTeamRef:{teamModal:document.querySelector(".team-modal"),teamModalBtn:document.querySelector(".tm-close-btn"),teamModalOpen:document.querySelector(".footer-link")},libraryRef:{libBtn:document.querySelector(".js-library"),homeBtn:document.querySelector(".js-home")},galleryRef:{moviesDiv:document.querySelector("#movies-gallery")},filmDetailsRef:{filmDetailsModalContainer:document.querySelector("#movies-gallery"),filmDetailsModalClose:document.querySelector('[data-action="close-modal"]'),modalBackdrop:document.querySelector(".js-backdrop"),filmDetailsModal:document.querySelector(".modal"),image:document.querySelector(".js-image"),title:document.querySelector(".js-title"),voteAverage:document.querySelector(".js-vote"),voteCount:document.querySelector(".js-vote-count"),popularity:document.querySelector(".js-popularity"),originTitle:document.querySelector(".js-title-orig"),genres:document.querySelector(".js-genres"),about:document.querySelector(".js-about"),btnWatched:document.querySelector(".js-btn-modal-watched"),btnQueue:document.querySelector(".js-btn-modal-queue")},footerRef:{},loaderRef:{loader:document.querySelector(".js-loader")},modalErrorRef:{modalError:document.querySelector(".windov-modal"),modalErrorText:document.querySelector(".error-modal__text")}}}function _(){p().loaderRef.loader.classList.add("is-hidden")}function v(){p().loaderRef.loader.classList.remove("is-hidden")}var y;y=new URL(i("kyEFX").resolve("9Q6Xn"),import.meta.url).toString();var L;L=new URL(i("kyEFX").resolve("6Auof"),import.meta.url).toString();const{IMAGE_BASE_URL_1X:E,IMAGE_BASE_URL_2X:R}=o;function b(e,n,a){const s=e.name||e.original_title;let i,o;return e.poster_path?(i=`${E+e.poster_path} 1x,${R+e.poster_path} 2x`,o=`${E+e.poster_path}`):(i=`${t(y)} 1x, ${t(L)} 2x`,o=t(y)),`<li class="gallery-card" data-id ="${e.id}">\n<a href="#" class="gallery-card__link">\n            <img srcset="${i}"\n  src="${o}" alt="${e.original_title}"  class="gallery-card__image" >\n  <div class="gallery-card__info">\n<p class="gallery-card__name">${s}</p>\n<p class="gallery-card__genre">${n} | ${a}</p>\n</div>\n</a>\n\t    </li>`}const{moviesDiv:w}=p().galleryRef;function A(e){const t=e.results.map((e=>function(e){const t=u(e);let n;n=e.release_date?Number.parseInt(e.release_date):Number.parseInt(e.first_air_date);return b(e,t,n)}(e))).join("");w.innerHTML=`<ul class="gallery-container">${t}</ul>`}var S={KEY_WATCHED:"added-watched",KEY_QUEUE:"added-queue",CURRENT_QUERY:"current-query",TRENDING:"trending",BY_KEY:"by-key",LIBRARY:"library"};const{API_KEY:j,API_BASE_URL:M,DETAILS_PATH_PARAMS:x}=o;async function k(e){const t=new URL(M+x+e);t.searchParams.set("api_key",j);try{const e=await fetch(t);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}return await e.json()}catch(e){console.log(e)}}const{IMAGE_BASE_URL_1X:q,IMAGE_BASE_URL_2X:I}=o;function $(e){let n,a,s=e.genres.map((e=>e.name));return s=s.length>3?[s[0],s[1],"Other"].join(", "):s.join(", "),e.poster_path?(n=`${q+e.poster_path} 1x,${I+e.poster_path} 2x`,a=`${q+e.poster_path}`):(n=`${t(y)} 1x, ${t(L)} 2x`,a=t(y)),`\n  <li class="gallery-card" data-id ="${e.id}">\n    <a href="#" class="gallery-card__item">\n      <img srcset="${n}"\n  src="${a}" alt="${e.original_title}"  class="gallery-card__image" >\n      <div class="gallery-card__info">\n        <p class="gallery-card__name">${e.title}</p>\n        <p class="gallery-card__genre">${s} | ${Number.parseInt(e.release_date)||"N/A"}\n        </p>\n      </div>\n    </a>        \n\t</li>`}function B(e){const t=localStorage.getItem(e);try{if(t){return JSON.parse(t)}return[]}catch(e){console.log(e)}}function T(e,t){const n=B(e);let a=[];if(n){if(n.includes(t))return;a=[...n,t]}else a=[t];const s=JSON.stringify(a);localStorage.setItem(e,s)}function P(e,t){const n=B(e);let a=[];if(n){a=[...n.filter((e=>e!==t))]}const s=JSON.stringify(a);localStorage.setItem(e,s)}var C;function D(e){let n="";const a=e>9?"":"is-hidden";for(let t=1;t<=e&&!(window.matchMedia("(max-width: 767px)").matches&&e>5&&6===t)&&!(e>9&&10===t);t+=1)n+=`<li class="pagination__item js-page" data-num='${t}'><a class="pagination__link" href="#">${t}</a></li>`;return`\n  <ul class="pagination__list pag-list-js">\n      <li class="button prev-js pagination__item"><svg class="button__icon" width="16" height ="16">\n          <use href="${t(C)}#arrow-right"></use>\n        </svg></li>\n      <li class="pagination__item first-js is-hidden hidden"><a class="pagination__link" href="#">1</a></li>\n      <li class="pagination__item prevMore-js is-hidden hidden"><a class="pagination__link" href="#">...</a></li>\n      ${n}\n      <li class="pagination__item ${a} nextMore-js hidden"><a class="pagination__link" href="#">...</a></li>\n      <li class="pagination__item ${a} last-js hidden"><a class="pagination__link" href="#">${e}</a></li>\n      <li class="button next-js pagination__item"><svg class="button__icon" width="16" height="16">\n          <use href="${t(C)}#arrow-left"></use>\n        </svg></li>\n\n    </ul>`}C=new URL(i("kyEFX").resolve("lp5u4"),import.meta.url).toString();const{paginationRef:N}=p();function U(e){const t=D(e);N.container.innerHTML=t}const{API_KEY:H,API_BASE_URL:Y,SEARCH_PATH_PARAMS:O}=o;async function F(e,t=1){const n=new URL(Y+O);n.searchParams.set("api_key",H),n.searchParams.set("page",t),n.searchParams.set("query",e);try{const e=await fetch(n);if(!e.ok){const t=await e.json();throw new Error(t.status_message)}const t=await e.json();if(t.results.length)return t;throw new Error("Nothing is found. Wrong query.")}catch(e){console.log(e)}}const{CURRENT_QUERY:G}=S;function Q(){try{const e=sessionStorage.getItem(G);return JSON.parse(e)}catch(e){console.log(e)}}function X(e,t=!0,n=1){const a={[e]:t,page:n};try{const e=JSON.stringify(a);sessionStorage.setItem(G,e)}catch(e){console.log(e)}}function K(e){const t=Q();try{t.page=e;const n=JSON.stringify(t);sessionStorage.setItem(G,n)}catch(e){console.log(e)}}const{TRENDING:W,BY_KEY:J,LIBRARY:z}=S,{paginationRef:{container:Z}}=p();let V,ee,te=1;function ne(e,t){ee=e,K(t),e<=1?ce():(t&&(te=t),U(e),V=p().paginationRef,se(),ie(),re(),V.paginationList.addEventListener("click",ae))}function ae(e){e.preventDefault(),e.target.classList.contains("pagination__item")&&(e.target.classList.contains("js-page")&&(te=Number(e.target.dataset.num)),e.target.classList.contains("prev-js")&&te>1&&(te-=1),e.target.classList.contains("next-js")&&te<ee&&(te+=1),e.target.classList.contains("first-js")&&(te=1,oe()),e.target.classList.contains("last-js")&&(te=ee,oe()),e.target.classList.contains("prevMore-js")&&(te=+V.pages[1].dataset.num,oe()),e.target.classList.contains("nextMore-js")&&(te=+V.pages[V.pages.length-2].dataset.num,oe()),async function(e){K(e);const t=Q();let n;v(),t[W]&&(n=await h(e),A(n));if(t[J]){const a=t[J];n=await F(a,e),A(n)}t[z]&&_e(e);_()}(te),se(),ie(),re())}function se(){V.pages.forEach((e=>{e.classList.remove("active"),+e.dataset.num===te&&e.classList.add("active")}))}function ie(){window.matchMedia("(min-width: 768px)").matches?ee>9&&(te<=5?(V.first.classList.add("is-hidden"),V.prevMore.classList.add("is-hidden"),V.pages[0].classList.remove("is-hidden"),V.pages[1].classList.remove("is-hidden")):(V.first.classList.remove("is-hidden"),V.prevMore.classList.remove("is-hidden"),V.pages[0].classList.add("is-hidden"),V.pages[1].classList.add("is-hidden")),function(){const e=V.pages.length-1;te>=ee-4?(V.last.classList.add("is-hidden"),V.nextMore.classList.add("is-hidden"),V.pages[e-1].classList.remove("is-hidden"),V.pages[e].classList.remove("is-hidden")):(V.last.classList.remove("is-hidden"),V.nextMore.classList.remove("is-hidden"),V.pages[e-1].classList.add("is-hidden"),V.pages[e].classList.add("is-hidden"))}(),te>=4&&te<=ee&&oe()):ee>5&&te>=2&&te<=ee&&oe(),se()}function oe(){let e=te-4;te<=1?e=te:te<=2?e=te-1:te<=3?e=te-2:te<=4&&(e=te-3),te>=ee?e=te-8:te>=ee-1?e=te-7:te>=ee-2?e=te-6:te>=ee-3&&(e=te-5),window.matchMedia("(max-width: 767px)").matches&&(e=te-2,te<=1?e=te:te<=2&&(e=te-1),te>=ee?e=te-4:te>=ee-1?e=te-3:te>=ee-2&&(e=te-2));for(let t=e,n=0;n<V.pages.length;t+=1,n+=1)V.pages[n].firstElementChild.textContent=t,V.pages[n].dataset.num=t}function re(){te<=1?V.prev.classList.add("disabled"):V.prev.classList.remove("disabled"),te>=ee?V.next.classList.add("disabled"):V.next.classList.remove("disabled")}function ce(){Z.innerHTML=""}window.addEventListener("resize",(function(){if(!V)return;window.matchMedia("(max-width: 767px)").matches&&!V.container.classList.contains("mobile-js")?(V.container.classList.remove("desktop-js"),V.container.classList.add("mobile-js"),ne(ee)):window.matchMedia("(min-width: 768px)").matches&&!V.container.classList.contains("desktop-js")&&(V.container.classList.remove("mobile-js"),V.container.classList.add("desktop-js"),ne(ee))}));const le=p().libraryButtonsRef.btnWatched,de=p().libraryButtonsRef.btnQueue,ue=p().galleryRef.moviesDiv;let me;function fe(){le.addEventListener("click",ge),de.addEventListener("click",he),ge(),X(S.LIBRARY),le.classList.add("active")}async function ge(e){let t;t="number"==typeof e?e:1,de.classList.remove("active"),le.classList.add("active"),ce(),K(t);const n=B(S.KEY_WATCHED);if(n&&0!==n.length){v(),me=await Promise.all(pe(n)),me=me.filter((e=>void 0!==e));const e=Math.ceil(me.length/20);e<t&&(t-=1),_e(t),ne(e,t),_()}else ue.innerHTML="You don't have any movies you've watched. Add the first one."}async function he(e){let t;t="number"==typeof e?e:1,de.classList.add("active"),le.classList.remove("active"),ce(),K(t);const n=B(S.KEY_QUEUE);if(n&&0!==n.length){v(),me=await Promise.all(pe(n)),me=me.filter((e=>void 0!==e));const e=Math.ceil(me.length/20);e<t&&(t-=1),_e(t),ne(e,t),_()}else ue.innerHTML="You don't have any movies in the queue. Add the first one."}function pe(e){return e.map((e=>new Promise((t=>{t(k(e)),reject(k(e))}))))}function _e(e=1){const t=me.slice(0+20*(e-1),20+20*(e-1)).map((e=>{if(e)return $(e)})).join("");ue.innerHTML=`<ul class="gallery-container">${t}</ul>`}async function ve(){v(),ce();const e=await h();A(e),X(S.TRENDING),ne(e.total_pages,1),_()}function ye(){p().headerRef.searchInput.value=null,p().headerRef.header.classList.add("header--home"),p().headerRef.header.classList.remove("header--library"),p().libraryButtonsRef.btnContainer.classList.add("display-none"),p().headerRef.searchForm.classList.remove("display-none"),p().libraryRef.homeBtn.classList.add("current"),p().libraryRef.libBtn.classList.remove("current"),ve()}v(),window.addEventListener("DOMContentLoaded",ve),p().libraryRef.homeBtn.addEventListener("click",ye),p().libraryRef.libBtn.addEventListener("click",(function(){p().headerRef.header.classList.remove("header--home"),p().headerRef.header.classList.add("header--library"),p().headerRef.searchForm.classList.add("display-none"),p().libraryButtonsRef.btnContainer.classList.remove("display-none"),p().libraryRef.libBtn.classList.add("current"),p().libraryRef.homeBtn.classList.remove("current"),ce(),fe()})),p().headerRef.navLogo.addEventListener("click",ye);const{modalError:Le,modalErrorText:Ee}=p().modalErrorRef;let Re=null;function be(e){Le.classList.remove("is-hidden"),function(e){Ee.innerHTML=`${e}`}(e),Re=setTimeout((()=>{we()}),3e3)}function we(){Le.classList.add("is-hidden")}Le.addEventListener("click",(function(){we(),clearInterval(Re)}));const{moviesDiv:Ae}=p().galleryRef,{searchForm:Se}=p().searchRef;let je="";Se.addEventListener("submit",(function(e){if(e.preventDefault(),je=e.target.elements.searchQuery.value.trim(),""===je){return be("Enter the name of the movie, for a correct search!")}v(),Ae.innerHTML="",ce(),F(je).then((e=>{if(e)X(S.BY_KEY,je),ne(e.total_pages,1),A(e),function(){const{top:e}=Ae.getBoundingClientRect();console.log(e),window.scrollBy({top:e,behavior:"smooth"})}();else{be("Nothing is found. Wrong query.")}})).finally(_),Se.elements.searchQuery.value=""}));const Me=S.KEY_WATCHED,xe=S.KEY_QUEUE,{btnWatched:ke,btnQueue:qe}=p().libraryButtonsRef,Ie=p().filmDetailsRef.btnWatched,$e=p().filmDetailsRef.btnQueue;function Be(e){Te(e),Pe(e),Ie.setAttribute("id",e),Ie.addEventListener("click",Ce),$e.setAttribute("id",e),$e.addEventListener("click",De)}function Te(e){B(Me).includes(e)?(Ie.setAttribute("actions","added"),Ie.classList.add("active"),Ie.textContent="Remove from Watched"):(Ie.setAttribute("actions","not-added"),Ie.classList.remove("active"),Ie.textContent="Add to Watched")}function Pe(e){B(xe).includes(e)?($e.setAttribute("actions","added"),$e.classList.add("active"),$e.textContent="Remove from Queue"):($e.setAttribute("actions","not-added"),$e.classList.remove("active"),$e.textContent="Add to Queue")}function Ce(e){const t=e.currentTarget.getAttribute("id");"added"===Ie.getAttribute("actions")?P(Me,t):(T(Me,t),P(xe,t)),Te(t),Pe(t),Q()[S.LIBRARY]&&(ke.classList.contains("active")?ge(Q().page):he(Q().page))}function De(e){const t=e.currentTarget.getAttribute("id");"added"===$e.getAttribute("actions")?P(xe,t):(T(xe,t),P(Me,t)),Te(t),Pe(t),Q()[S.LIBRARY]&&(ke.classList.contains("active")?ge(Q().page):he(Q().page))}const{filmDetailsRef:Ne}=p();async function Ue(e){const{IMAGE_BASE_URL_1X:n,IMAGE_BASE_URL_2X:a}=o;e.poster_path?(Ne.image.srcset=`${n}${e.poster_path} 1x, ${a}${e.poster_path} 2x`,Ne.image.src=`${n}${e.poster_path}`):(console.log("yaya"),Ne.image.srcset=`${t(y)} 1x, ${t(L)} 2x`,Ne.image.src=t(y),Ne.image.alt="Movie photo"),Ne.image.alt=e.title,Ne.title.textContent=e.title,Ne.voteAverage.textContent=e.vote_average,Ne.voteCount.textContent=e.vote_count,Ne.popularity.textContent=Number(e.popularity.toFixed(1)),Ne.originTitle.textContent=e.original_title,Ne.genres.textContent=e.genres.map((e=>e.name)).join(", "),Ne.about.textContent=e.overview}const{filmDetailsRef:He}=p();function Ye(){window.addEventListener("keydown",Fe),document.body.classList.add("show-modal"),He.filmDetailsModal.classList.remove("is-hidden")}function Oe(){window.removeEventListener("keydown",Fe),document.body.classList.remove("show-modal"),He.filmDetailsModal.classList.add("is-hidden"),document.body.style.overflow="",Ne.image.src="#"}function Fe(e){"Escape"===e.code&&Oe()}let Ge;He.filmDetailsModalClose.addEventListener("click",Oe),He.modalBackdrop.addEventListener("click",(function(e){e.currentTarget===e.target&&Oe()})),He.filmDetailsModalContainer.addEventListener("click",(async function(e){if(e.preventDefault(),!e.target.closest(".gallery-card"))return;v();let t=e.target.closest(".gallery-card").dataset.id;const n=await k(t);n?(Ue(n),Be(t),Ye()):be("Oops, movie not found. Please, choose another movie");_()})),Ge=p().modalTeamRef,Ge.teamModalOpen.addEventListener("click",(function(e){function t(){window.removeEventListener("click",a),window.removeEventListener("keydown",n),Ge.teamModalBtn.removeEventListener("click",s)}function n(e){"Escape"===e.key&&(Ge.teamModal.classList.add("is-hidden"),t())}function a(e){e.target===Ge.teamModal&&(Ge.teamModal.classList.add("is-hidden"),t())}function s(e){Ge.teamModal.classList.add("is-hidden"),t()}e.preventDefault(),Ge.teamModal.classList.remove("is-hidden"),window.addEventListener("keydown",n),window.addEventListener("click",a),Ge.teamModalBtn.addEventListener("click",s)}));document.querySelector(".switcher-toggle").addEventListener("change",(function(){document.body.classList.toggle("theme-dark")}));
//# sourceMappingURL=index.e1fde615.js.map
